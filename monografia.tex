% ------------------------------------------------------------------------
% ------------------------------------------------------------------------
% Monografia Peacon
% Trabalho de Conclusão de Curso
% Baseia-se no documento modelo de TCC do abntex2
% Para saber mais, acesse https://github.com/abntex/abntex2
% ------------------------------------------------------------------------
% ------------------------------------------------------------------------

\documentclass[
		% -- opções da classe memoir --
		12pt,				% tamanho da fonte
		openright,			% capítulos começam em pág ímpar (insere página vazia caso preciso)
		oneside,			% para impressão em verso e anverso. Oposto a oneside
		a4paper,			% tamanho do papel. 
		% -- opções da classe abntex2 --
		chapter=TITLE,		% títulos de capítulos convertidos em letras maiúsculas
		%section=TITLE,		% títulos de seções convertidos em letras maiúsculas
		%subsection=TITLE,	% títulos de subseções convertidos em letras maiúsculas
		%subsubsection=TITLE,% títulos de subsubseções convertidos em letras maiúsculas
		% -- opções do pacote babel --
		english,			% idioma adicional para hifenização
		brazil				% o último idioma é o principal do documento
	]{abntex2}


% ----------------------------------------------------------
% Pacotes básicos 
% ----------------------------------------------------------
%\usepackage{helvet}			
\usepackage[scaled]{helvet}
\renewcommand*\familydefault{\sfdefault} 	% Only if the base font of the document is to be sans serif
										% Foi necessário para acertar o documento, continha diversos erros
\usepackage[T1]{fontenc}		% Selecao de codigos de fonte.
\usepackage[utf8]{inputenc}	% Codificacao do documento (conversão automática dos acentos)
\usepackage{lastpage}		% Usado pela Ficha catalográfica
\usepackage{indentfirst}		% Indenta o primeiro parágrafo de cada seção.
\usepackage{color}			% Controle das cores
\usepackage{graphicx}		% Inclusão de gráficos
\usepackage{microtype} 		% para melhorias de justificação
% ----------------------------------------------------------
		

% ----------------------------------------------------------
% Pacotes adicionais, usados apenas no âmbito do Modelo Canônico do abnteX2
%% ----------------------------------------------------------
\usepackage{lipsum}				% para geração de dummy text
\usepackage{customizacoes} 		% customizações feitas pelo autor
% ----------------------------------------------------------


% ----------------------------------------------------------
% Pacotes de citações
% ----------------------------------------------------------
\usepackage[alf]{abntex2cite}				% Citações padrão ABNT

% ----------------------------------------------------------
% CONFIGURAÇÕES DE PACOTES
% ----------------------------------------------------------

% ----------------------------------------------------------
% Configurações do pacote backref
% ----------------------------------------------------------
\definecolor{thered}{rgb}{0.65,0.04,0.07}
\definecolor{thegreen}{rgb}{0.06,0.44,0.08}
\definecolor{thegrey}{gray}{0.5}
\definecolor{theshade}{rgb}{1,1,0.97}
\definecolor{theframe}{gray}{0.6}
% ----------------------------------------------------------


% ----------------------------------------------------------
% Informações de dados para CAPA e FOLHA DE ROSTO
% ----------------------------------------------------------

\titulo{Desenvolvimento de um Protótipo de Rastreador de Beacons utilizando o Raspberry Pi}
\autor{Gabriel Luiz Bastos Oliveira}
\local{Bauru}
\data{2015}
\orientador{Prof. Dr. Eduardo Martins Morgado}
\instituicao{%
  Universidade Estadual Paulista "Júlio de Mesquita Filho"
  \par
  Faculdade de Ciências - Campus Bauru
  \par
  Departamento de Computação
}
\tipotrabalho{Monografia (Trabalho de Conclusão de Curso)}
% O preambulo deve conter o tipo do trabalho, o objetivo, 
% o nome da instituição e a área de concentração 
% foi necessário utilizar \~{a} e etc para os acentos por problemas na geração do PDF
\preambulo{Trabalho de Conclus\~{a}o de Curso apresentado ao Departamento de Computa\c{c}\~{a}o da Faculdade de Ci\^{e}ncias da Universidade Estadual Paulista “J\'{ú}lio de Mesquita Filho” – UNESP, C\^{a}mpus de Bauru.}

% ----------------------------------------------------------


% ----------------------------------------------------------
% Configurações de aparência do PDF final
% ----------------------------------------------------------

% alterando o aspecto da cor azul
\definecolor{blue}{RGB}{0,0,0}

% informações do PDF
\makeatletter
\hypersetup{
     	%pagebackref=true,
		pdftitle={\@title}, 
		pdfauthor={\@author},
    	pdfsubject={\imprimirpreambulo},
	    pdfcreator={LaTeX with abnTeX2},
		pdfkeywords={beacon}{raspberry pi}{internet das coisas}{abntex2}{trabalho acadêmico}, 
		colorlinks=true,       		% false: boxed links; true: colored links
    	linkcolor=blue,          	% color of internal links
    	citecolor=blue,        		% color of links to bibliography
    	filecolor=magenta,      		% color of file links
		urlcolor=blue,
		bookmarksdepth=4
}
\makeatother
% ----------------------------------------------------------


% ----------------------------------------------------------
% Espaçamentos entre linhas e parágrafos 
% ----------------------------------------------------------

% O tamanho do parágrafo é dado por:
\setlength{\parindent}{1.3cm}

% Controle do espaçamento entre um parágrafo e outro:
\setlength{\parskip}{0.2cm}  % tente também \onelineskip

% ----------------------------------------------------------
% compila o indice
% ----------------------------------------------------------
\makeindex
% ----------------------------------------------------------


% ----------------------------------------------------------
% Configurações de projeto
% ----------------------------------------------------------
\newif\iffinal
\finaltrue % define se é um arquivo final, se for não for retira umas partes. 

\newif\ifrelatorio
\relatoriofalse % define se é um arquivo final, se for não for retira umas partes. 

\newif\ifabstract
\abstractfalse % define se mostra o abstract em inglês ou não.

\newif\ifresumo
\resumotrue % define se mostra o resumo ou não.

\newif\ifficha
\fichafalse % define se mostra a ficha catalográfica ou não
% ----------------------------------------------------------


% ----------------------------------------------------------
% Início do documento
% ----------------------------------------------------------
\begin{document}

% Seleciona o idioma do documento (conforme pacotes do babel)
%\selectlanguage{english}
\selectlanguage{brazil}

% Retira espaço extra obsoleto entre as frases.
\frenchspacing 

% ----------------------------------------------------------
% ELEMENTOS PRÉ-TEXTUAIS
% ----------------------------------------------------------
\pretextual


% ----------------------------------------------------------
% Capa
% ----------------------------------------------------------
\imprimircapa
% ----------------------------------------------------------


% ----------------------------------------------------------
% Folha de rosto
% (o * indica que haverá a ficha bibliográfica)
% ----------------------------------------------------------
\imprimirfolhaderosto
% ----------------------------------------------------------


% ----------------------------------------------------------
% Inserir a ficha catalográfica
% ----------------------------------------------------------

% Isto é um exemplo de Ficha Catalográfica, ou "Dados internacionais de
% catalogação-na-publicação''. Você pode utilizar este modelo como referência. 
% Porém, provavelmente a biblioteca da sua universidade lhe fornecerá um PDF
% com a ficha catalográfica definitiva após a defesa do trabalho. Quando estiver
% com o documento, salve-o como PDF no diretório do seu projeto e substitua todo
% o conteúdo de implementação deste arquivo pelo comando abaixo:
%
% \begin{fichacatalografica}
%     \includepdf{fig_ficha_catalografica.pdf}
% \end{fichacatalografica}

\ifficha
  \begin{fichacatalografica}
	\sffamily
	\vspace*{\fill}					% Posição vertical
	\begin{center}					% Minipage Centralizado
	\fbox{\begin{minipage}[c][8cm]{13.5cm}		% Largura
	\small
	\imprimirautor
	%Sobrenome, Nome do autor
	
	\hspace{0.5cm} \imprimirtitulo  / \imprimirautor. --
	\imprimirlocal, \imprimirdata-
	
	\hspace{0.5cm} \pageref{LastPage} p. : il. (algumas color.) ; 30 cm.\\
	
	\hspace{0.5cm} \imprimirorientadorRotulo~\imprimirorientador\\
	
	\hspace{0.5cm}
	\parbox[t]{\textwidth}{\imprimirtipotrabalho~--~\\ \imprimirinstituicao,
	\imprimirdata.}\\
	
	\hspace{0.5cm}
		1. Beacon.
		2. Raspberry Pi.
		3. Internet das Coisas.
		I. \imprimirorientador.
		II. Universidade Estadual Paulista "Júlio de Mesquita Filho".
		III. Faculdade de Ciências.
		IV. Título
	\end{minipage}}
	\end{center}
  \end{fichacatalografica}
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% Inserir errata
% ----------------------------------------------------------
%\begin{errata}
%Elemento opcional da \citeonline[4.2.1.2]{NBR14724:2011}. Exemplo:

%\vspace{\onelineskip}

%FERRIGNO, C. R. A. \textbf{Tratamento de neoplasias ósseas apendiculares com
%reimplantação de enxerto ósseo autólogo autoclavado associado ao plasma
%rico em plaquetas}: estudo crítico na cirurgia de preservação de membro em
%cães. 2011. 128 f. Tese (Livre-Docência) - Faculdade de Medicina Veterinária e
%Zootecnia, Universidade de São Paulo, São Paulo, 2011.

%\begin{table}[htb]
%\center
%\footnotesize
%\begin{tabular}{|p{1.4cm}|p{1cm}|p{3cm}|p{3cm}|}
%  \hline
%   \textbf{Folha} & \textbf{Linha}  & \textbf{Onde se lê}  & \textbf{Leia-se}  \\
%    \hline
%    1 & 10 & auto-conclavo & autoconclavo\\
%   \hline
%\end{tabular}
%\end{table}

%\end{errata}
% ----------------------------------------------------------


% ----------------------------------------------------------
% Inserir folha de aprovação
% ----------------------------------------------------------

% Isto é um exemplo de Folha de aprovação, elemento obrigatório da NBR
% 14724/2011 (seção 4.2.1.3). Você pode utilizar este modelo até a aprovação
% do trabalho. Após isso, substitua todo o conteúdo deste arquivo por uma
% imagem da página assinada pela banca com o comando abaixo:
%
% \includepdf{folhadeaprovacao_final.pdf}
%
\begin{folhadeaprovacao}
	\begin{center}
		{\ImprimirAutor}
		
		\vspace*{\fill}\vspace*{\fill}
		\begin{center}
			\bfseries\large\ImprimirTitulo
		\end{center}
		\vspace*{\fill}
   
		\hspace{.45\textwidth}
		\begin{minipage}{.5\textwidth}
			\imprimirpreambulo
		\end{minipage}%
		\vspace*{\fill}
     
		%Trabalho aprovado. \imprimirlocal, 24 de novembro de 2012:
   
		\uppercase{Banca examinadora}
	\end{center}
	
	Aprovado em \detokenize{___/___/___}.

	\assinatura{\textbf{\imprimirorientador} \\ Orientador} 
	\assinatura{\textbf{Prof. Dr. Aparecido Nilceu Marana}}
	\assinatura{\textbf{Profa. Dra. Márcia A. Z. Meira e Silva}}
	%\assinatura{\textbf{Professor} \\ Convidado 3}
	%\assinatura{\textbf{Professor} \\ Convidado 4}
	
	\vspace*{0.5cm}
	\hspace{.5\textwidth}
	\begin{center} 
		{ \ImprimirLocal \\ \imprimirdata }
	\end{center}
\end{folhadeaprovacao}
% ----------------------------------------------------------


% ----------------------------------------------------------
% Dedicatória
% ----------------------------------------------------------
\ifrelatorio
	\begin{dedicatoria} 
		\vspace*{\fill}
		\centering
		\noindent
		\textit{ Este trabalho é dedicado às crianças adultas que,\\
				quando pequenas, sonharam em se tornar cientistas.} 
		\vspace*{\fill}
	\end{dedicatoria}
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% Agradecimentos
% ----------------------------------------------------------
\iffinal
	\begin{agradecimentos}

Agradeço ao meu orientador Prof. Dr. Eduardo Morgado, por todo o tempo e trajetória no LTIA\footnote{Laboratório de Tecnologia da Informação Aplicada}, pela confiança, apoio e incentivo. Agradeço também pelo auxílio em todas as etapas desse projeto, desde a definição do tema até a apresentação final.

A Henrique Lopes Santos, pela ajuda na realização das fotos e também criação do logotipo para o protótipo.

A Elisa Castro, pelo apoio na correção e melhorias na digitação do texto contido nesse documento.

A Giovanna Aguirre, pelo apoio, incentivo, paciência e companhia nos momentos mais importantes de minha vida.

A todos os colegas do laboratório, pela incrível parceria, trabalho em equipe e organização de projetos. Os quatro anos percorridos com eles foram essenciais para meu crescimento profissional e pessoal.

A todos os professores, pois com muito esforço diário passaram não somente as informações técnicas e práticas de cada disciplina, mas lições que servirão para toda vida.

A todos os colegas de curso, que de alguma forma auxiliaram a chegar ao último semestre da melhor maneira possível.

Aos meus amigos e familiares, pelo apoio e incentivo na escolha e decorrer do curso, com muita compreensão e encorajamento.

	\end{agradecimentos}
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% Epígrafe
% ----------------------------------------------------------
\iffinal
	\begin{epigrafe}
		\vspace*{\fill}
			\begin{flushright}
			%\textit{"Sonhos não morrem, apenas \\ 
			%	 adormecem na alma da gente."\\
			%(Francisco Cândido Xavier)}
			\textit{"Que eu não perca a vontade de ajudar as pessoas, \\
				mesmo sabendo que muitas delas são incapazes \\
				de ver, reconhecer e retribuir esta ajuda."\\
				(Francisco Cândido Xavier)}
		\end{flushright}
	\end{epigrafe}
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% RESUMOS
% ----------------------------------------------------------
\ifresumo
	% resumo em português
	\setlength{\absparsep}{18pt} % ajusta o espaçamento dos parágrafos do resumo
	\begin{resumo}

	 		FALTA ACERTAR!!!!!! Atualmente a área da internet das coisas tem recebido um foco enorme. Um dos motivos é devido a ser bem nova e também facilitar a integração das pessoas com o mundo real. Essa área tem motivado várias pessoas pela possibilidade de ter um produto concreto após pouco tempo de trabalho. Por conta disso, alguns dispositivos foram criados para auxiliar essas áreas, entre eles o \textit{Arduino} e \textit{Raspberry Pi}. Os \textit{beacons} também são uma criação nova, comunicando com outros dispositivos maiores como o \textit{RPi} para auxiliar a micro-localização dentro de um pequeno espaço, com um baixo custo. O seu foco de uso é pequeno, somente com leituras via \textit{smartphones}. Esse projeto tem como objetivo criar um rastreador de \textit{beacons} utilizando o \textit{Raspberry Pi} para expandir essa capacidade, não necessitando de um celular para que os \textit{beacons} possam ser encontrados.

 			\textbf{Palavras-chave}: \textit{Beacon}. Raspberry Pi. Internet das Coisas.
 			
	\end{resumo}
	
	% resumo em inglês
	\begin{resumo}[Abstract]
	 	\begin{otherlanguage*}{english}
			This is the english abstract.

			\textbf{Keywords}: Beacon. Raspberry Pi. Internet of Things.
		\end{otherlanguage*}
	\end{resumo}
	
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% inserir lista de ilustrações
% ----------------------------------------------------------
\iffinal
	\pdfbookmark[0]{\listfigurename}{lof}
	\listoffigures*
	\cleardoublepage
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% inserir lista de tabelas
% ----------------------------------------------------------
\iffinal
	\pdfbookmark[0]{\listtablename}{lot}
	\listoftables*
	\cleardoublepage
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% inserir lista de abreviaturas e siglas
% ----------------------------------------------------------
\iffinal
	\begin{siglas}
			\item[IoT] \textit{Internet of Things} - Internet das Coisas
			\item[DIY] \textit{Do It Yourself} - Faça Você Mesmo
			\item[RPi] \textit{Raspberry Pi}
			\item[GPIO] \textit{General Input and Output}
			\item[BLE] \textit{Bluetooth Low Energy}
			\item[LTIA] Laboratório de Tecnologia da Informação Aplicada
	\end{siglas}
\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% inserir lista de símbolos
% ----------------------------------------------------------
%\iffinal
%	\begin{simbolos}
%			\item[$ \Gamma $] Letra grega Gama
%			\item[$ \Lambda $] Lambda
%			\item[$ \zeta $] Letra grega minúscula zeta
%			\item[$ \in $] Pertence
%	\end{simbolos}
%\fi
% ----------------------------------------------------------


% ----------------------------------------------------------
% inserir o sumario
% ----------------------------------------------------------
\pdfbookmark[0]{\contentsname}{toc}
\tableofcontents*
\cleardoublepage
% ----------------------------------------------------------



% ----------------------------------------------------------------------------------------------------------------------------------



% ----------------------------------------------------------------------------------------------------------------------------------
% ELEMENTOS TEXTUAIS
% ----------------------------------------------------------------------------------------------------------------------------------
\textual


% ----------------------------------------------------------
% Introdução
% ----------------------------------------------------------

\include{introducao}

% ----------------------------------------------------------


% ----------------------------------------------------------
% Objetivos
% ----------------------------------------------------------

\include{objetivos}

% ----------------------------------------------------------


% ----------------------------------------------------------
% Fundamentação Teórica
% ----------------------------------------------------------

\include{fundamentacao}

% ----------------------------------------------------------


% ----------------------------------------------------------
% Materiais e Métodos
% ----------------------------------------------------------
\chapter{Materiais e Métodos}\label{cap:materiais-e-metodos}
% ----------------------------------------------------------

% ----------------------------------------------------------
\section{Métodos e Etapas}\label{sec:metodos-etapas}
% ----------------------------------------------------------

O projeto foi dividido em etapas para facilitar o desenvolvimento completo. A primeira etapa foi o levantamento bibliográfico relacionado ao tema, realizadas buscas relacionadas aos assuntos: \textit{Raspberry Pi}, comunicação via \textit{Bluetooth Low Energy}, \textit{beacons}. Concomitantemente foi realizado o estudo das tecnologias, levando em conta suas capacidades, limitações, e aplicações.

A segunda etapa foi planejar o projeto baseado na análise do levantamento bibliográfico, assim como a definição de sua estrutura. Essa etapa foi necessária para facilitar e agilizar a implementação e testes dos componentes nas próximas etapas, definindo assim um escopo inicial de funcionalidades que o sistema terá, assim como outras tarefas a serem realizadas. O processo está detalhado no \autoref{cap:desenvolvimento} - \nameref{cap:desenvolvimento}.

A terceira etapa foi a implementação e testes do protótipo. As funcionalidades foram desenvolvidas por parte e em seguida testadas, seguindo a metodologia de desenvolvimento ágil.

Todo o projeto foi desenvolvido no espaço do LTIA\footnote{Laboratório de Tecnologia da Informação Aplicada - \url{http://www.ltia.fc.unesp.br/}}, da Universidade Estadual Paulista "Júlio de Mesquita Filho"\ - Campus Bauru.


% ----------------------------------------------------------
\section{Materiais Utilizados}\label{sec:materiais-utilizados}
% ----------------------------------------------------------

% ---
\subsection{Raspberry Pi e Acessórios}\label{sec:rpi-acessorios}
% ---

A versão do Raspberry Pi escolhida para o projeto foi a 2 Modelo B, por ter mais processamento e mais memória RAM (\autoref{fig:rpi2-utilizado}), conforme informado na \autoref{sec:raspberry-pi}.

\begin{figure}[htb]
	\caption{\label{fig:rpi2-utilizado}\textit{RPi} 2 modelo B utilizado nesse projeto.}
	\begin{center}
		\includegraphics[width=0.5\textwidth]{img/rpi2.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

É necessário o uso de um adaptador \textit{WiFi} para conexão a internet sem necessidade de cabo \textit{Ethernet} e também um adaptador Bluetooth 4.0 com suporte a \textit{BLE} para fazer a busca dos pacotes \textit{beacon}. Os modelos de adaptadores usados foram Orico BTA-406 (bluetooth) e EDUP N8508GS (\textit{WiFi}), conforme \autoref{fig:adaptadores}. O \textit{RPi} e os adaptadores são de propriedade do autor.

\begin{figure}[htb]
	\caption{\label{fig:adaptadores}Orico BTA-406 a esquerda e EDUP N8508GS a direita.}
	\begin{center}
		\includegraphics[width=0.35\textwidth]{img/adaptadores.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

O sistema operacional executado no RPi é instalado em um cartão microSD, com no mínimo 4 GB de espaço. O cartão utilizado nesse projeto é um SanDisk Ultra Class 10 de 8 GB, conforme \autoref{fig:cartaomicrosd}. O sistema utilizado foi o Raspbian Wheezy. Durante o desenvolvimento do projeto, a versão Raspbian Jessie foi lançada, com inúmeras melhorias, porém preferiu-se por permanecer na versão Wheezy para evitar possíveis incompatibilidades com os softwares utilizados.

\begin{figure}[htb]
	\caption{\label{fig:cartaomicrosd}Cartão microSD SanDisk Ultra Class 10 utilizado no projeto.}
	\begin{center}
		\includegraphics[width=0.3\textwidth]{img/cartaomicrosd.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Na \autoref{sec:tecnologias-ferramentas} - \nameref{sec:tecnologias-ferramentas}, \autoref{sec:rpi-tecnologia} - \nameref{sec:rpi-tecnologia} será abordado como o \textit{RPi} funciona na prática, como foi utilizado para esse projeto e como suas capacidades foram aproveitadas.

% ---
\subsection{Computadores e Softwares}\label{sec:comp-softwares}
% ---

A conexão com o \textit{RPi} foi realizada utilizando \textit{SSH}\footnote{\textit{Secure Shell}}, sem necessidade de monitor e teclado. O computador utilizado no projeto foi um MacBook Pro com sistema Mac OS X 10.10 (posteriormente atualizado para 10.11), de propriedade do autor. Nesse sistema o uso de \textit{SSH} é simples, basta abrir o aplicativo Terminal e utilizar o comando "\textit{ssh usuario@computador}", conforme \autoref{fig:ex-terminal}. Esse tipo de abordagem é bastante utilizada para conexão a servidores na nuvem, para executar comandos, softwares, entre outros.

\begin{figure}[htb]
	\caption{\label{fig:ex-terminal}Conexão com o \textit{RPi} via \textit{SSH}.}
	\begin{center}
		\includegraphics[width=0.7\textwidth]{img/terminal-pi.png}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

% ---
\subsection{Smartphones e Tablets}\label{sec:smartphone-tablets}
% ---

Foi utilizado o smartphone Moto Maxx com sistema Android 5.0.1 e o tablet iPad mini Retina com sistema iOS 8.4 confirme \autoref{fig:motomaxx-ipad}. 

O aplicativo utilizado em ambos foi o \textit{Locate Beacon} da \textit{Radius Networks}, que nos permite identificar os \textit{beacons} e também simular um, para realizar os testes com diferentes tipos, podendo alterar os valores de UUID, Major, Minor e potência de transmissão. 

O Moto Maxx é de propriedade do autor, e o iPad é de propriedade do LTIA, foi utilizado nas dependências do laboratório.

\begin{figure}[htb]
	\caption{\label{fig:motomaxx-ipad}Moto Maxx (esquerda) e iPad Mini (direita).}
	\begin{center}
		\includegraphics[width=0.7\textwidth]{img/motomaxx-ipad.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

% ---
\subsection{Beacons}\label{sec:beacons-modo}
% ---

O \textit{beacon} utilizado para testes foi o \textit{Zebra MPact}, conforme \autoref{fig:zebra-mpact}. Utiliza uma bateria CR2450 para alimentação de energia. 

\begin{figure}[htb]
	\caption{\label{fig:zebra-mpact}\textit{Beacon} Zebra MPact utilizado para testes.}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/beacon-mpact2.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

A \textit{Zebra} tem um sistema de administração e gerenciamento nomeado \textit{MPact Toolbox}, instalado em um servidor do LTIA com sistema Debian 8.1. Esse sistema foi utilizado somente para conhecimento da tecnologia \textit{beacon} e atualização do \textit{firmware}, somente disponível por essa \textit{Toolbox}. Esse software também apresenta a porcentagem de bateria, conforme \autoref{fig:exemplo-toolbox}. 

Permite a configuração de vários \textit{beacons} simultaneamente, além de alterar o modo de funcionamento, de \textit{iBeacon} para \textit{MPact}, protocolo criado pela fabricante. Os \textit{beacons} são de propriedade do LTIA, e foram utilizados dentro das dependências do laboratório em todas as etapas.

\begin{figure}[htb]
	\caption{\label{fig:exemplo-toolbox}\textit{Beacon} configurado na \textit{Toolbox} apresentando a porcentagem de bateria.}
	\begin{center}
		\includegraphics[width=0.7\textwidth]{img/toolbox-exemplo.png}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

% ---
\subsection{Acessórios para o Protótipo}\label{sec:acess-prototipo}
% ---

O protótipo foi criado em uma caixa de metal (\autoref{fig:caixa-metal}), furada conforme projeto e pintada de preto. Esse processo está detalhado na \autoref{sec:segunda-etapa}. 

\begin{figure}[htb]
	\caption{\label{fig:caixa-metal}Caixa de metal utilizada para o protótipo}
	\begin{center}
		\includegraphics[width=0.8\textwidth]{img/caixa-metal.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Para o protótipo final foram utilizados seis LEDs, resistores, barra de pinos, um display azul de 16 colunas por 2 linhas, três botões do tipo clique, cabos \textit{flat} do tipo IDE e \textit{floppy}, placas com furação para soldagem de componentes, cabos finos removidos de um cabo de rede \textit{ethernet} para ligações entre os componentes e cola quente para fixação dos componentes internos. Esses materiais podem ser vistos na \autoref{fig:prot-interno}.

Durante a fase de estudo das tecnologias utilizou-se uma protoboard e fios de conexão (\autoref{fig:proto-teste}) para testes de código, modo de conexão, entre outros, detalhado na \autoref{sec:segunda-etapa}.

\begin{figure}[htb]
	\label{teste}
	\centering
 	\begin{minipage}{0.43\textwidth}
		\centering
		\caption{\label{fig:prot-interno}Parte interna do protótipo}
		\includegraphics[width=0.7\textwidth]{img/prot-interno.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
	\hfill
	\begin{minipage}{0.55\textwidth}
		\centering
		\caption{\label{fig:proto-teste}Protoboard na etapa de estudo}
		\includegraphics[width=1\textwidth]{img/proto-teste.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

Como o \textit{RPi} tem limitações quanto a quantidade de pinos de entrada e saída digitais (explicados na \autoref{sec:rpi-tecnologia}), os componentes definidos para o protótipo foram determinados conforme possibilidade de conexões. Cada componente necessita de:

\begin{alineas}
	\item Para cada LED, um pino de saída digital (GPIO) para acender ou apagar;
	\item Para cada botão, um pino de entrada digital para leitura de botão pressionado ou não;
	\item Para o display de LCD, seis pinos de saída no total, sendo quatro para dados, um para \textit{enable} (ou ativar), e outro para \textit{register select}, para posicionar os dados nos registradores corretos.
\end{alineas}

O uso desses componentes foram determinados na segunda etapa, detalhada na \autoref{sec:segunda-etapa} - \nameref{sec:segunda-etapa}.


% ----------------------------------------------------------
\section{Tecnologias e Ferramentas}\label{sec:tecnologias-ferramentas}
% ----------------------------------------------------------


% ---
\subsection{Raspberry Pi}\label{sec:rpi-tecnologia}
% ---

O \textit{RPi} é a tecnologia mais importante desse projeto. Já foi abordado na \autoref{sec:raspberry-pi} e \autoref{sec:rpi-acessorios}, porém nessa seção outros aspectos serão comentados.

% TODO Falar das GPIOs, quantidade de pinos digitais, voltagem 3.3V


% ---
\subsection{Node.js}\label{sec:node-js}
% ---

% TODO falar dos pacotes utilizados, npm

% ---
\subsection{CouchDB}\label{sec:couchdb}
% ---



% ---
\subsection{Git}\label{sec:git}
% ---

Git é um software de controle de versão para repositórios. Registra as mudanças nos arquivos (ou grupo de arquivos) ao longo do tempo, de forma que as versões possam ser recuperadas futuramente. \cite{pro-git}. Se for necessário voltar algumas versões por bug no código, mal funcionamento de uma função recém implementada ou outras razões, as alterações estarão todas salvas.

Atualmente o Git é muito utilizado por projetos de código aberto, como por exemplo o Swift\footnote{\url{https://github.com/apple/swift}} que é uma linguagem de programação criada pela Apple voltada para seus sistemas operacionais, e o AngularJS\footnote{\url{https://github.com/angular/angular.js}}, framework Javascript mantido pelo Google.

É possível configurar o repositório local para sincronizar com um repositório remoto, por meio de \texttt{push} (enviar mudanças) e \texttt{pull} (buscar mudanças). Dessa forma promove a divisão do trabalho, removendo o problema de sincronização de código entre diferentes máquinas e pessoas.

% ---
\subsubsection{GitHub}\label{sec:github}
% ---



% ---
\subsection{Outras Ferramentas}\label{sec:outras-ferramentas}
% ---

Durante o desenvolvimento desse trabalho foi necessário a criação de uma proposta e um relatório parcial, ambos para a disciplina de Projeto e Implementação de Sistemas I. Para tal, o autor utilizou a ferramenta denominada LaTeX. Como não está entre os objetivos desse projeto, mas é informação de grande acréscimo, está detalhado no \autoref{ap:latex}.


% ----------------------------------------------------------


% ----------------------------------------------------------
% Experimentos e Resultados
% ----------------------------------------------------------
\chapter{Desenvolvimento}\label{cap:desenvolvimento}
% ----------------------------------------------------------

% ----------------------------------------------------------
\section{Primeira Etapa}\label{sec:primeira-etapa}
% ----------------------------------------------------------

Nessa etapa foram realizados os estudos práticos das tecnologias. O primeiro experimentos realizado foi a tentativa de identificação de um \textit{beacon} com o \textit{RPi}, para o estudo de funcionamento e comportamento dessas tecnologias. Para isso, o ambiente foi configurado conforme \autoref{fig:inicio-ambiente}. 

\begin{figure}[htb]
	\caption{\label{fig:inicio-ambiente}Primeiro teste realizado, com \textit{RPi} e \textit{beacon MPact}}
	\begin{center}
		\includegraphics[width=0.65\textwidth]{img/ambiente1.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

O computador ficou conectado via SSH com o \textit{RPi}, recebendo as informações de leitura de pacotes \textit{BLE}. Os softwares utilizados para isso foram, conforme \citeonline{stack-overflow-ibeacon}, os seguintes:

\begin{alineas}
	\item \textbf{hcitool}: configurado da maneira \textit{hcitool lescan --duplicates}, faz um scan na frequência \textit{BLE} procurando por dispositivos que estejam transmitindo, conforme \autoref{fig:hcitool-lescan}.
	
	\begin{figure}[htb]
		\caption{\label{fig:hcitool-lescan}Software \textit{hcitool} executando}
		\begin{center}
			\includegraphics[width=0.6\textwidth]{img/hcitool-lescan.png}
		\end{center}
		\legend{Fonte: elaborado pelo autor}
	\end{figure}

	\item \textbf{hcidump}: em conjunto com o \textit{hcitool}, apresenta todos os pacotes escaneados na rede. Executado da maneira \textit{hcidump --raw}, conforme \autoref{fig:hcidump}.
	
	\begin{figure}[htb]
		\caption{\label{fig:hcidump}Software \textit{hcidump} executando}
		\begin{center}
			\includegraphics[width=0.6\textwidth]{img/hcidump.png}
		\end{center}
		\legend{Fonte: elaborado pelo autor}
	\end{figure}

\end{alineas}

Em seguida, com os softwares em execução e os pacotes sendo analisados, o \textit{beacon} foi movido em cima da mesa para ficar a diferentes distâncias do \textit{RPi}, conforme \autoref{fig:movimenta-beacon}. Esse passo foi necessário para verificar o formato dos pacotes recebidos e também analisar a distância máxima de identificação.

\begin{figure}[htb]
	\caption{\label{fig:movimenta-beacon}Teste com movimentação do \textit{beacon}}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/ambiente4.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Com o adaptador Orico BTA-406 e posicionamento na mesa conforme \autoref{fig:inicio-ambiente} e \autoref{fig:movimenta-beacon}, cerca de 1,3 a 1,4 metros de distância entre o \textit{RPi} e o \textit{beacon} os pacotes já começaram a falhar e a leitura não ser tão constante.

O posicionamento do \textit{RPi} foi alterado para testes, conforme \autoref{fig:posiciona-rpi}. Notou-se uma melhoria na recepção dos pacotes, a 1,5 metros entre o \textit{RPi} e o \textit{beacon} os pacotes começaram a falhar, com recepção notada até 1,6 metros.

\begin{figure}[htb]
	\caption{\label{fig:posiciona-rpi}\textit{RPi} posicionado de outra maneira}
	\begin{center}
		\includegraphics[width=0.8\textwidth]{img/ambiente2.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Durante essa etapa não foram levado em consideração conexões com LEDs, botões e display LCD para a montagem do protótipo pois esses componentes foram definidos posteriormente. Os estudos e testes desses materiais foram realizados na segunda etapa, para que as escolhas fossem validadas.

% ----------------------------------------------------------
\section{Segunda Etapa}\label{sec:segunda-etapa}
% ----------------------------------------------------------

Na segunda etapa iniciou-se o planejamento do protótipo. Para que pudesse ser bem planejado, definiu-se alguns parâmetros:

\begin{alineas}
	\item deve ter uma interface amigável e simples para interação com o software;
	\item deve ser bem apresentável, com cores marcantes e boa construção;
	\item deve mostrar informações relevantes sobre o sistema - aplicação, software e sistema (Linux e \textit{RPi});
	\item deve ser construído em um único pacote, não muito grande nem muito pequeno;
\end{alineas}

Seguindo esses parâmetros, a primeira busca foi por um pacote de onde alocar todos os componentes necessários, de forma que tudo ficasse bem protegido. Para tal, escolheu-se uma caixa de metal, derivada de uma antiga caixa de cigarros, apresentado na \autoref{sec:acess-prototipo}.

O material foi cortado primeiramente na parte de baixo de forma que acomode o \textit{RPi} deixando todas as conexões disponíveis para futuro desenvolvimento e facilidade de acessar as portas. Foram realizados furos na parte do fundo para fixação do \textit{RPi} com parafusos, arruelas e porcas, conforme \autoref{fig:rpi-caixa}.

% TODO - FOTO DO FUNDO COM OS PARAFUSOS

\begin{figure}[htb]
	\caption{\label{fig:rpi-caixa}\textit{RPi} preso na caixa, com as portas acessíveis}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/rpi-caixa.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Dessa maneira o RPi ficou bem preso na parte de baixo, liberando a tampa para instalação da interface com o usuário.

No próximo passo definiu-se como seria a interface com o usuário. Para que os parâmetros fossem cumpridos, os seguintes itens necessários foram elencados:

\begin{alineas}
	\item apresentará uma informação se o sistema está rodando a aplicação corretamente - para tal definiu-se o uso de um LED verde;
	\item apresentará uma informação se o sistema tem conexão com a internet - para tal definiu-se o uso de um LED amarelo;
	\item apresentará uma informação se um beacon está no alcance - para tal definiu-se o uso de um LED azul;
	\item apresentará várias informações textuais sobre o estado atual do sistema, assim como beacons no alcance, histórico, dados do Linux, endereço de IP, temperatura da CPU - para tal, definiu-se o uso de um display LCD de 16 colunas por 2 linhas.
	\nota{A cor dos LEDs foi definido por praticidade e diversificação.}
\end{alineas}

Como o display é pequeno e não apresentaria todas as informações de uma só vez, decidiu-se que existiria alguma forma de navegação por páginas, de forma que as informações fossem alteradas conforme mudasse de página. Para que a navegação fosse realizada de maneira agradável e apresentável, os seguintes itens foram escolhidos:

\begin{alineas}
	\item LEDs indicam qual página o usuário está - definiu-se pelo uso de três LEDs verde, a cor foi escolhida somente por praticidade de já ter os componentes;
	\item botões do tipo clique foram usados para navegar a direita, esquerda, e entre as páginas, similar ao rolar a página.
\end{alineas}

Seriam utilizado mais LEDs para mais informações serem apresentadas, como mais páginas no display, porém por limitação da quantidade de GPIOs preferiu-se por manter somente três páginas e LEDs.

Com os componentes bem definidos, em seguida a interface foi desenhada no papel, conforme \autoref{fig:interface-papel}.

\begin{figure}[htb]
	\caption{\label{fig:interface-papel}\textit{RPi} posicionado de outra maneira}
	\begin{center}
		\includegraphics[width=0.52\textwidth]{img/interface-papel.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Definido os componentes que fariam parte da interface, foi necessário realizar testes com os LEDs, display LCD e botões na protoboard de forma que todos esses componentes pudessem ser conectados ao mesmo tempo. 

Nesse momento definiu-se o uso de Node.js (detalhado na \autoref{sec:node-js}) para o desenvolvimento, pois foram encontrados diversos tutoriais\footnote{\url{http://thejackalofjavascript.com/rpi-16x2-lcd-print-stuff/}}\footnote{\url{http://odesenvolvedor.andafter.org/publicacoes/controlando-gpio-do-raspberrypi-com-nodejs.html}}\footnote{\url{https://learn.adafruit.com/node-embedded-development/why-node-dot-js}} e bibliotecas\footnote{\url{https://www.npmjs.com/package/lcd}}\footnote{\url{https://www.npmjs.com/package/onoff}} que facilitariam a conexão com todos os componentes.

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.47\textwidth}
		\centering
		\caption{\label{fig:proto-lcd}Estudo de conexão e programação com display LCD}
		\includegraphics[width=1\textwidth]{img/proto-lcd.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
	\hfill
	\begin{minipage}{0.47\textwidth}
		\centering
		\caption{\label{fig:proto-leds}Conexão com LEDs, display e botão na protoboard}
		\includegraphics[width=1\textwidth]{img/proto-leds.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

\begin{figure}[htb]
	\caption{\label{fig:proto-total}Teste de mesa com todos os componentes}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/proto-total.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Após realizar todos os estudos e testes de conexão com sucesso, o próximo passo foi a montagem da interface na caixa de metal. Primeiro os cortes foram feitos com uma ferramenta específica tipo esmeril, em seguida a caixa foi pintada com tinta preta fosca (\autoref{fig:pintar-1} e \autoref{fig:pintar-2}) para que o protótipo ficasse com boa construção, cor e amigável.

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.47\textwidth}
		\centering
		\caption{\label{fig:pintar-1}Pintura da caixa de metal - tampa}
		\includegraphics[width=1\textwidth]{img/pintar-1.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
	\hfill
	\begin{minipage}{0.47\textwidth}
		\centering
		\caption{\label{fig:pintar-2}Pintura da caixa de metal - base}
		\includegraphics[width=1\textwidth]{img/pintar-2.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

Enquanto a tinta secava foi necessário realizar soldas e montagem dos outros componentes em placas para que tudo ficasse organizado e fácil de ser trocado, caso necessário. O rascunho de conexão das GPIOs com os componentes de hardware estão marcados na \autoref{fig:pinout-gpio}.

Cada LED foi conectado a uma GPIO, a um resistor de 330$\Omega$, e ao GND. Os botões foram conectados seguindo o modelo da \autoref{fig:push-btn-sketch}, com um resistor de 10K$\Omega$ e uma GPIO para cada botão. O display foi conectado diretamente a cada GPIO marcada, e também ao +5V e GND para alimentação. 

O modelo de display LCD utilizado também tem um pino que utiliza voltagem variável para iluminar cada caractere (contraste de cada letra), e um pino para a iluminação do fundo (azul). Para essas conexões foram utilizados potenciômetros de 10K, para facilitar mudanças caso necessário. Dessa forma, só é necessário girar o pino do potenciômetro para alterar a saída.

Foram utilizados seis GPIOs para os LEDs, três para os botões e seis para o display, totalizando 15 GPIOs de 17 disponíveis. As GPIOs utilizadas foram:

\begin{alineas}
	\item Para os LEDs de interface (topo), GPIO 12, 6 e 5, respectivamente 1, 2 e 3;
	\item Para os LEDs de informação (baixo), GPIO 22, 27 e 17, respectivamente Power, Internet e Beacon;
	\item Para os botões, GPIOs 24, 23 e 18, respectivamente botão esquerdo, central e direito;
	\item Para o display de LCD, GPIOs 16, 20, 13, 19, 26, 21, respectivamente Register Select, Enable, Data 1, Data 2, Data 3 e Data 4.
	\nota{Os números das GPIOs foram escolhidos devido a proximidade e agrupamento dos componentes.}
\end{alineas}

\begin{figure}[htb]
	\caption{\label{fig:pinout-gpio}Rascunho de conexão das GPIOs}
	\begin{center}
		\includegraphics[width=0.5\textwidth]{img/pinout-gpio.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:push-btn-sketch}Modelo de conexão dos botões}
		\includegraphics[width=1\textwidth]{img/push-btn-sketch.png}
		\legend{Fonte: \cite{push-button}}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:potentiometer}Potenciômetros de configuração do display LCD}
		\includegraphics[width=1\textwidth]{img/potentiometer.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

De forma que a tampa saísse facilmente optou-se por usar um cabo flat frequentemente usado em HDs antigos (padrão IDE) conectado ao \textit{RPi} e a uma placa central com duas fileiras de 20 pinos.

Utilizando os fios internos de cabo de rede para conexão entre os componentes nas placas, o mesmo cabo flat cortado para conexão entre as placas para uma maior flexibilidade e facilidade de mudanças, criou-se o controle da interface, como pode ser visto na \autoref{fig:interface-traz1} e \autoref{fig:interface-traz2}.

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:interface-traz1}Parte interna da interface - parcialmente desmontada}
		\includegraphics[width=1\textwidth]{img/interface-traz1.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:interface-traz2}Parte interna da interface - completamente montada}
		\includegraphics[width=1\textwidth]{img/interface-traz2.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

As placas internas da interface foram afixadas com cola quente, para que os cabos fossem reforçados e não quebrasse nenhuma conexão. Tampa e base foram conectados com o cabo flat (\autoref{fig:tampa-base}) e o protótipo ficou pronto para desenvolvimento da aplicação.

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:tampa-base}Conexão da tampa com a base}
		\includegraphics[width=1\textwidth]{img/tampa-base.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:prot-final}Criação e montagem do protótipo finalizada}
		\includegraphics[width=1\textwidth]{img/prot-final-2.jpg}
		\legend{Fonte: elaborado pelo autor}
	\end{minipage}
\end{figure}

Após o hardware estar totalmente montado, montou-se a estrutura de informações que iriam aparecer nas telas, conforme \autoref{fig:estrutura-telas}. As telas apresentam as seguintes informações:

\begin{alineas}
	\item A primeira tela mostra informações sobre os beacons no alcance, ou caso não haja nenhum, apresenta o texto "\texttt{Aguardando beacons}". As subtelas apresentam informações sobre quais beacons estão no alcance, sendo o nome atribuidos a eles ou então o texto "\texttt{Desconhecido}"\ caso não esteja no banco de dados. A quantidade de subtelas depende da quantidade de beacons no alcance, por isso não se sabe ao certo a quantidade total;
	\item A segunda tela apresenta um histórico dos beacons encontrados durante a execução do programa, com um contador da quantidade de beacons no histórico, e as subtelas apresentam o nome do beacon encontrado em ordem numérica. Se um beacon for encontrado diversas vezes, será repetido nas subtelas. Conforme a primeira tela, a quantidade de subtelas depende da quantidade de beacons no histórico, por isso não se sabe ao certo a quantidade total;
	\item A terceira tela apresenta informações relevantes sobre o sistema, sendo elas:
	\begin{subalineas}
		\item Primeira subtela apresenta o \textit{load average}\footnote{Segundo \citeonline{load-average}, essa informação de três números apresenta a média de carga da CPU por um certo tempo. O primeiro número é a média no último minuto, o segundo número é a média nos últimos cinco minutos, e o terceiro número é a média nos últimos quinze minutos} do sistema Linux. É relevante para saber se o sistema está muito carregado ou trabalhando tranquilamente;
		\item Segunda subtela apresenta a temperatura do processador. É relevante para saber se o sistema está trabalhando a uma temperatura segura ou está sobreaquecendo;
		\item Terceira subtela apresenta o endereço de IP privado da rede. É de extrema importância para conexão remota, pois é esse endereço que é utilizado para conexão via \textit{SSH};
		\item Quarta subtela apresenta o endereço de IP público da rede. É relevante para saber se está conectado direto a internet (o IP privado será igual ao IP público) ou em uma subrede, como de uma residência ou do laboratório.
	\end{subalineas}
\end{alineas}

\begin{figure}[htb]
	\caption{\label{fig:estrutura-telas}Definição das informações apresentadas nas telas}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/estrutura-telas.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Após todos esses passos o protótipo estava bem definido para o desenvolvimento.\\


% ---
\subsection{Problemas Enfrentados}\label{sec:problemas-enfrentados}
% ---

Durante os estudos e testes dos LEDs na protoboard utilizou-se resistores de 330$\Omega$ para conexão correta. Quanto maior o valor da resistência, menos brilho o LED terá. Como os componentes estavam na protoboard, não percebeu-se que os LEDs utilizados eram de alto brilho.

Para soldagem final dos componentes, preferiu-se por manter os resistores de 330$\Omega$ por questões práticas. Porém os LEDs ficaram com muito brilho, incomodando qualquer pessoa que olhasse diretamente para o protótipo, conforme \autoref{fig:led-forte-1} e \autoref{fig:led-forte-2}.

\begin{figure}[htb]
	\caption{\label{fig:led-forte-1}LED de alto brilho ao olhar diretamente}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/led-forte-1.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

\begin{figure}[htb]
	\caption{\label{fig:led-forte-2}LEDs de alto brilho refletindo na mesa}
	\begin{center}
		\includegraphics[width=0.6\textwidth]{img/led-forte-2.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

Como os componentes já estavam afixados com cola quente, substituir os resistores levaria muito tempo e possivelmente atrasaria o desenvolvimento do projeto, portanto optou-se por manter dessa maneira. Para um futuro protótipo, resistores maiores, ou LEDs com menos brilho seriam essenciais.

% ----------------------------------------------------------
\section{Terceira Etapa}\label{sec:terceira-etapa}
% ----------------------------------------------------------

Na terceira etapa realizou-se o desenvolvimento da aplicação, testes e aquisição de dados. A aplicação foi dividida em módulos por maior facilidade de desenvolvimento, testes e descoberta de erros. Um arquivo de configurações globais, nomeado \texttt{globals-config.js}, foi utilizado para todas as definições de constantes de forma a facilitar futuras mudanças, caso necessário. 

% ---
\subsection{Primeiro Módulo}\label{sec:primeiro-modulo}
% ---

O primeiro módulo desenvolvido foi a interface, que consiste da conexão com LEDs, botões e display LCD. Optou-se por criar uma biblioteca auxiliar para abstrair métodos repetitivos e também irrelevantes para os outros módulos. Como esse módulo é o meio de acesso do código principal aos componentes de hardware, foram adicionados trechos de teste para acender o LED e apagar o LED pela linha de comando, de forma que os testes de funcionalidade pudessem ser realizados.

Durante a fase de testes do primeiro módulo, um fato interessante ocorreu. Ao clicar uma única vez em um botão, em algumas vezes o código executava dois, três ou até mais cliques de botão. Pesquisando mais a fundo sobre esse erro, uma informação nova surgiu. 

Botões mecânicos não criam ou perdem o contato corretamente, conforme caso ideal e perfeito representado no Gráfico~\ref{fig:debounce-graph-1}. Em vez disso, podem oscilar rapidamente no momento do clique ou ao soltar o botão, conforme Gráfico~\ref{fig:debounce-graph-2}. \cite{debounce-graph}. Esse efeito é conhecido como \textit{bounce}, ou ruído.

\begin{figure}[htb]
	\centering
 	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:debounce-graph-1}Gráfico ideal de um clique de botão}
		\includegraphics[width=0.8\textwidth]{img/debounce-graph-1.jpg}
		\legend{Fonte: \cite{debounce-graph}}
	\end{minipage}
	\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		\caption{\label{fig:debounce-graph-2}Gráfico real de um clique de botão}
		\includegraphics[width=0.8\textwidth]{img/debounce-graph-2.jpg}
		\legend{Fonte: \cite{debounce-graph}}
	\end{minipage}
\end{figure}

A solução para resolver esse problema (denominada \textit{debounce}) foi de, em seguida a um clique, bloquear todos os próximos cliques via programação por determinado tempo (em milissegundos), de forma que não interferisse diretamente nos cliques reais do usuário. Esse tempo foi determinado por testes repetitivos e de diferentes usuários em 200ms. Esse valor foi considerado ideal por evitar o ruído e não interferir em cliques seguidos do usuário. Valores maiores, como 300ms afetaram o clique do usuário, e valores inferiores como 100ms não evitaram totalmente o ruído.

% ---
\subsection{Segundo Módulo}\label{sec:segundo-modulo}
% ---

Páginas e Navegação entre telas

% ---
\subsection{Terceiro Módulo}\label{sec:terceiro-modulo}
% ---

Identificação dos Beacons e apresentação nas telas corretas

% ---
\subsection{Quarto Módulo}\label{sec:quarto-modulo}
% ---

Procurar beacon no banco de dados local

% ---
\subsection{Quinto Módulo}\label{sec:quinto-modulo}
% ---

Salvar beacons encontrados no banco de dados local

% ---
\subsection{Protótipo Final}\label{sec:prototipo-final}
% ---

Mostrar logo e falar sobre protótipo final

\begin{figure}[htb]
	\caption{\label{fig:prod-final}Protótipo finalizado e totalmente funcional}
	\begin{center}
		\includegraphics[width=0.8\textwidth]{img/prod-final.jpg}
	\end{center}
	\legend{Fonte: elaborado pelo autor}
\end{figure}

% ----------------------------------------------------------


% ----------------------------------------------------------
% Conclusão
% ----------------------------------------------------------
\chapter{Conclusão}
% ----------------------------------------------------------

FALTA ACERTAR!!!! Esse projeto tem como objetivo o aprofundamento na área de Internet das Coisas, pelo estudo das tecnologias de \textit{Bluetooth Low Energy}, \textit{Raspberry Pi} e \textit{beacons}. O resultado final será um protótipo de rastreador de \textit{beacons} utilizando o \textit{Raspberry Pi}, ainda em desenvolvimento.

A fundamentação teórica realizada por meio de pesquisa bibliográfica no início do projeto foi essencial para entender como os protocolos \textit{beacons} foram propostas e implementadas, como é o comportamento do \textit{Raspberry Pi}, entre outros. Em conjunto, o estudo das tecnologias foi de extrema importância para entender o funcionamento e utilização do \textit{RPi} e \textit{beacon}.

Certas atividades de extrema importancia ainda serão realizadas, mas o projeto ainda tem muitos frutos para render, caminhando em uma boa direção. A área de Internet das Coisas é uma área extremamente promissora, com áreas de pesquisa e implementação bem vastas. 

% ----------------------------------------------------------

% ----------------------------------------------------------------------------------------------------------------------------------



% ----------------------------------------------------------
% ELEMENTOS PÓS-TEXTUAIS
% ----------------------------------------------------------

% ----------------------------------------------------------
% Referências bibliográficas
% ----------------------------------------------------------
\bibliography{referencias}
% ----------------------------------------------------------

% ----------------------------------------------------------
% Apêndices
% ----------------------------------------------------------

% ---
% Inicia os apêndices
% ---
\begin{apendicesenv}

\include{latex}

\end{apendicesenv}
% ---

% ----------------------------------------------------------


\end{document}